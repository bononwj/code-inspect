import badgen from 'badgen';
import { writeFileSync } from 'fs';
import { ensureDirSync } from 'fs-extra';
import { join } from 'path';
export default class {
    constructor(options) {
        this.options = options;
    }
    report(...args) {
        const [, statistic] = args;
        const badgeOptions = this.options.reportersOptions ? this.options.reportersOptions.badge || {} : {};
        const badge = badgen({
            color: this.getColor(statistic),
            status: this.getStatus(statistic),
            subject: 'Copy/Paste',
            ...badgeOptions
        });
        ensureDirSync(this.options.output);
        writeFileSync(badgeOptions.path ? badgeOptions.path : join(this.options.output, 'jscpd-badge.svg'), badge);
    }
    attach() {
    }
    getStatus(statistic) {
        return statistic ? statistic.total.percentage + '%' : 'N/A';
    }
    getColor(statistic) {
        if (!statistic || !statistic.hasOwnProperty('threshold')) {
            return 'grey';
        }
        return statistic.total.percentage < statistic.threshold ? 'green' : 'red';
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxNQUFNLE1BQU0sUUFBUSxDQUFDO0FBQzVCLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxJQUFJLENBQUM7QUFDbkMsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLFVBQVUsQ0FBQztBQU16QyxPQUFPLEVBQUUsSUFBSSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBWTVCLE1BQU0sQ0FBQyxPQUFPO0lBRVosWUFBb0IsT0FBaUI7UUFBakIsWUFBTyxHQUFQLE9BQU8sQ0FBVTtJQUNyQyxDQUFDO0lBRU0sTUFBTSxDQUFDLEdBQUcsSUFBdUI7UUFDdEMsTUFBTSxDQUFDLEVBQUUsU0FBUyxDQUFDLEdBQXNCLElBQUksQ0FBQztRQUM5QyxNQUFNLFlBQVksR0FBa0IsSUFBSSxDQUFDLE9BQU8sQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxnQkFBZ0IsQ0FBQyxLQUFLLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUM7UUFDbkgsTUFBTSxLQUFLLEdBQUcsTUFBTSxDQUFDO1lBQ25CLEtBQUssRUFBRSxJQUFJLENBQUMsUUFBUSxDQUFDLFNBQVMsQ0FBQztZQUMvQixNQUFNLEVBQUUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxTQUFTLENBQUM7WUFDakMsT0FBTyxFQUFFLFlBQVk7WUFDckIsR0FBRyxZQUFZO1NBQ2hCLENBQUMsQ0FBQztRQUNILGFBQWEsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQ25DLGFBQWEsQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFNLEVBQUUsaUJBQWlCLENBQUMsRUFBRSxLQUFLLENBQUMsQ0FBQztJQUM3RyxDQUFDO0lBRU0sTUFBTTtJQUNiLENBQUM7SUFFTSxTQUFTLENBQUMsU0FBcUI7UUFDcEMsT0FBTyxTQUFTLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsVUFBVSxHQUFHLEdBQUcsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFBO0lBQzdELENBQUM7SUFFTSxRQUFRLENBQUMsU0FBcUI7UUFDbkMsSUFBSSxDQUFDLFNBQVMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxjQUFjLENBQUMsV0FBVyxDQUFDLEVBQUU7WUFDeEQsT0FBTyxNQUFNLENBQUM7U0FDZjtRQUNELE9BQU8sU0FBUyxDQUFDLEtBQUssQ0FBQyxVQUFVLEdBQUcsU0FBUyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUM7SUFDNUUsQ0FBQztDQUNGIn0=